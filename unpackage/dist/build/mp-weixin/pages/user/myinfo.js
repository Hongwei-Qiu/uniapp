(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/myinfo"],{"0974":function(e,t,a){"use strict";var n={"uni-nav-bar":function(){return a.e("components/uni-nav-bar/uni-nav-bar").then(a.bind(null,"01c8"))},"uni-icons":function(){return Promise.all([a.e("common/vendor"),a.e("components/uni-icons/uni-icons")]).then(a.bind(null,"4aa4"))}},o=function(){var e=this,t=e.$createElement;e._self._c},i=[];a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}))},"88fb":function(e,t,a){"use strict";a.r(t);var n=a("98b6"),o=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=o.a},"98b6":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("3782")),o=i(a("fe41"));function i(e){return e&&e.__esModule?e:{default:e}}var r=getApp().globalData,u=r.appid,c=r.appsecret,d=r.imgRemote,f=r.navBar,m=function(){a.e("components/ling-imgcropper/ling-imgcropper").then(function(){return resolve(a("28b0"))}.bind(null,a)).catch(a.oe)},s={components:{ImageCropper:m},data:function(){return{tempFilePath:"",cropFilePath:"",showtitle:!0,navBar:f,imgUrl:r.imgUrl,imgRemote:d,phone:"",memberInfoData:"",member_default:"",nickname:"",password:"",confirmPwd:"",imgPath:""}},methods:{memberInfo:function(){var e=this,t=Math.round((new Date).getTime()/1e3),a={appid:u,timeStamp:t},i=n.default.hexMD5(o.default.objKeySort(a)+c),r={appid:u,timeStamp:t,sign:i};o.default.getRequests("memberInfo",r,(function(t){if(200==t.data.code){var a=/^(\d{3})\d*(\d{4})$/;e.memberInfoData=t.data.data.info,e.cropFilePath=e.memberInfoData.logo,e.nickname=e.memberInfoData.nickname,e.member_default=t.data.data.member_default,e.phone=t.data.data.info.phone.replace(a,"$1****$2")}}))},leftClick:function(){e.navigateBack({delta:1})},bindPhonePage:function(){e.navigateTo({url:"bindphone"})},upload:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],success:function(e){t.showtitle=!1,t.tempFilePath=e.tempFilePaths.shift()}})},confirm:function(t){this.showtitle=!0,this.tempFilePath="";var a=t.detail.tempFilePath,i="avatars",d=Math.round((new Date).getTime()/1e3),f={appid:u,type:i,timeStamp:d},m=n.default.hexMD5(o.default.objKeySort(f)+c),s=this;e.uploadFile({method:"POST",url:r.rootUrl+"/mobileOrder/uploadImg",name:"img",header:{Authorization:e.getStorageSync("cdj_token")},formData:{appid:u,timeStamp:d,type:i,img:a,sign:m},filePath:a,success:function(e){var t=JSON.parse(e.data);s.imgPath=t.data.path,s.cropFilePath=t.data.src,s.uploadAvatar()}})},uploadAvatar:function(){var t=this,a=t.imgPath,i=Math.round((new Date).getTime()/1e3),r={appid:u,img:a,timeStamp:i},d=n.default.hexMD5(o.default.objKeySort(r)+c),f={appid:u,img:a,timeStamp:i,sign:d};o.default.postRequests("uploadAvatar",f,(function(t){200==t.data.code&&e.showToast({title:"更换头像成功",icon:"none"})}))},formSubmit:function(){var t=this;if(0==t.memberInfoData.is_password){if(!t.password)return void o.default.Toast("密码不能为空");if(!t.confirmPwd)return void o.default.Toast("确认密码不能为空");if(t.password!=this.confirmPwd)return void o.default.Toast("密码和确认密码不一致")}var a=t.nickname.replace(/\s+/g,""),i=Math.round((new Date).getTime()/1e3),r={appid:u,timeStamp:i},d=n.default.hexMD5(o.default.objKeySort(r)+c),f={appid:u,nickname:a,password:t.password,confirm_pwd:t.confirmPwd,timeStamp:i,sign:d};o.default.postRequests("saveMemberInfo",f,(function(t){200==t.data.code?(o.default.Toast("修改成功"),setTimeout((function(){e.navigateBack({delta:1})}),1e3)):o.default.Toast(t.data.msg)}))},cancel:function(){this.showtitle=!0}},onShow:function(){var e=this;e.memberInfo()}};t.default=s}).call(this,a("543d")["default"])},c01a:function(e,t,a){},c32c:function(e,t,a){"use strict";(function(e){a("47a8"),a("921b");n(a("66fd"));var t=n(a("e6de"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},e6de:function(e,t,a){"use strict";a.r(t);var n=a("0974"),o=a("88fb");for(var i in o)"default"!==i&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("f833");var r,u=a("f0c5"),c=Object(u["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);t["default"]=c.exports},f833:function(e,t,a){"use strict";var n=a("c01a"),o=a.n(n);o.a}},[["c32c","common/runtime","common/vendor"]]]);